{% extends "base.html" %}

{% block content %}
<table>
    <tr>
        <th>Words</th>
        <th>POS</th>
        <th>Occurences</th>
    </tr>
    {% for word in words %}
    <tr>

        <td>
            <input type="checkbox", name="cb_word", onchange="modifySubmit(this)" id="{{word.lemme}}">
            <label for="{{word.lemme}}">{{ word.lemme }}</label>

        </td>
        <td>{{ word.pos }}</td>
        <td>{{ word.doc_freq }}</td>
    </tr>
    {% endfor %}
</table>

<div id = "select_words_validate"> </div>
<p id="confirmation"></p>

<script>

   let nb_selected = 0
   modifySubmit(checkbox){
   if(checkbox.checked == true){
    nb_selected += 1
    }
   else{
    nb_selected -= 1
    }
   if (document.querySelector("#submit_select") == null){
   document.querySelector("#select_words_validate").insertAdjacentHTML("afterbegin", "<button type='submit' id='submit_select'> Validate Selection (' + nb_selected + 'words) </button>')
   } else{
   document.querySelector("#submit_select").innerHTML = " Validate Selection? (" + nb_selected + " words)"

   }
   }

   document.querySelector("#submit_select").onsubmit = async (event) =>
{
   let selected_words = [];
   let checkboxes = document.getElementsByName("cb_word");
   for (const checkbox of checkboxes) {
      if (checkbox.checked) {
            selected_words.push(checkbox.id);
        }
    }

   const confirm_message = "Do you want to generate " + nb_selected Â©+ " flashcards?";
   document.getElementById("confirmation").innerHTML = confirm_message;
}
</script>
{% endblock %}